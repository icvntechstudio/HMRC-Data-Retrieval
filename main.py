import os
import requests
import csv
from datetime import datetime
from hmrc_client import HMRCClient  # Import the HMRCClient class from your hmrc_client.py

# Your Companies House API Key
api_key = os.getenv('COMPANIES_API_KEY')

# Function to get company name from Companies House API
def get_company_name(company_number):
    url = f"https://api.company-information.service.gov.uk/company/{company_number}"
    response = requests.get(url, auth=(api_key, ''))
    data = response.json()
    
    # Check if company information is returned
    if "company_name" in data:
        return data["company_name"]
    return None

# Function to get all directors' details (name and age) from Companies House API
def get_directors_details(company_number):
    url = f"https://api.company-information.service.gov.uk/company/{company_number}/officers"
    response = requests.get(url, auth=(api_key, ''))
    data = response.json()
    
    directors = []
    # Check if there are officers
    if "items" in data:
        for officer in data["items"]:
            # Only check for active directors
            if officer.get("officer_role") == "director":
                name = officer.get("name", "N/A")
                birth_year = officer.get("date_of_birth", {}).get("year")
                if birth_year:
                    age = datetime.now().year - int(birth_year)
                    directors.append(f"{name} (Age: {age})")
    return directors

# Function to get company turnover using HMRCClient
def get_company_turnover(client, vat_number):
    return client.get_company_turnover(vat_number)

# Prepare to write data to CSV
with open('directors_age_and_company.csv', 'w', newline='') as csvfile:
    fieldnames = ['Company Number', 'Company Name', 'Directors (Name and Age)', 'Annual Turnover']
    writer = csv.DictWriter(csvfile, fieldnames=fieldnames)
    
    # Write header
    writer.writeheader()

    # List of company numbers to process
    company_numbers = [
        "11496595",
        "12475415",
        "5068342",
        "14100739",
        "12183563",
        "8633737",
        "12881603",
        "3142120",
        "7806663",
        "8450505",
        "12648196",
        "14274989",
        "3511288",
        "10053122",
        "5047365",
        "7145959",
        "4710905",
        "10098684",
        "13398789",
        "14477795",
        "5379815",
        "12290224",
        "7603387",
        "4583158",
        "4852446",
        "6042958",
        "11131159",
        "15313919",
        "4702367",
        "9125796",
        "2505138",
        "4468597",
        "13619737",
        "9091783",
        "6303146",
        "15360517",
        "4877764",
        "1833186",
        "10081015",
        "7697507",
        "5351580",
        "9728460",
        "12309330",
        "8226388",
        "11675977",
        "8264535",
        "13079127",
        "14096343",
        "9260454",
        "10870692",
        "7092100",
        "3775537",
        "8541602",
        "8118233",
        "10192801",
        "10904261",
        "9854631",
        "605844",
        "6787476",
        "7317262",
        "12279927",
        "6255227",
        "7134255",
        "5872639",
        "2256270",
        "8340872",
        "11497756",
        "6098890",
        "9285192",
        "6930857",
        "5468731",
        "5636073",
        "2262817",
        "13017274",
        "4680170",
        "10343750",
        "15027640",
        "5761972",
        "4961789",
        "8825573",
        "6113457",
        "3996472",
        "7334653",
        "5388559",
        "4977219",
        "5490601",
        "8521699",
        "7709176",
        "6866998",
        "5389299",
        "6002319",
        "10266893",
        "6003709",
        "3550352",
        "9792069",
        "8186219",
        "12234281",
        "5125679",
        "13370385",
        "6980465",
        "5053028",
        "6678208",
        "11176546",
        "8786814",
        "11011980",
        "9953356",
        "9756442",
        "1852489",
        "4710943",
        "4670962",
        "8274845",
        "5978971",
        "4384324",
        "6517102",
        "14730367",
        "8922673",
        "5620948",
        "3795153",
        "3988901",
        "1916151",
        "9224710",
        "10774266",
        "11519587",
        "4636470",
        "2831896",
        "10398415",
        "8671757",
        "11681595",
        "8762328",
        "8454905",
        "8976511",
        "10570807",
        "4582195",
        "2970292",
        "910387",
        "7770320",
        "7074320",
        "11012510",
        "4637909",
        "9106924",
        "12464380",
        "4344891",
        "12848688",
        "6884717",
        "9164202",
        "14039657",
        "8946415",
        "6602715",
        "3334400",
        "14675991",
        "14058518",
        "8939185",
        "8692261",
        "5072498",
        "13270489",
        "5629291",
        "9836363",
        "5460494",
        "980328",
        "4271766",
        "13143672",
        "10500269",
        "7893941",
        "6644826",
        "9595073",
        "12630851",
        "9545326",
        "4196954",
        "10696183",
        "6909201",
        "10917329",
        "14133734",
        "7163500",
        "10249069",
        "13783282",
        "6653530",
        "7831596",
        "11387750",
        "5310681",
        "10717369",
        "11301619",
        "2709399",
        "10289581",
        "3732022",
        "OC374869",
        "5485298",
        "2570399",
        "9889100",
        "8515570",
        "3237705",
        "14056385",
        "13425641",
        "12238662",
        "11627975",
        "2067510",
        "6283629",
        "9612809",
        "735607",
        "11349274",
        "11641537",
        "14206947",
        "7631461",
        "13028148",
        "10950359",
        "12755810",
        "5344448",
        "12931891",
        "7172818",
        "2498745",
        "7624249",
        "10989414",
        "7577699",
        "5049403",
        "8080567",
        "8149555",
        "11195319",
        "9362257",
        "7294835",
        "3087327",
        "7443998",
        "6593251",
        "9629488",
        "6879562",
        "6137578",
        "12811936",
        "6853453",
        "5927479",
        "11174518",
        "13201734",
        "8533104",
        "13117747",
        "8772872",
        "12253974",
        "4525082",
        "11192298",
        "13982512",
        "12956617",
        "8029869",
        "10795061",
        "8362642",
        "13389197",
        "10135550",
        "4599024",
        "4166155",
        "10443212",
        "4568776",
        "11992880",
        "9671665",
        "3139965",
        "5205504",
        "3661292",
        "7879818",
        "6799409",
        "4705750",
        "9644336",
        "4936166",
        "7656377",
        "7545155",
        "9853526",
        "13756017",
        "13408678",
        "11744438",
        "FC022519",
        "9992596",
        "13709835",
        "7781923",
        "4039888",
        "3461565",
        "12896045",
        "14217915",
        "9096107",
        "12455483",
        "8506338",
        "4444119",
        "4202350",
        "4756722",
        "12133564",
        "7816508",
        "12121578",
        "7921741",
        "7807668",
        "1307015",
        "2777103",
        "6280419",
        "13953741",
        "8821307",
        "5464528",
        "11716362",
        "6501267",
        "13221746",
        "1712266",
        "4863991",
        "4345937",
        "9260561",
        "10174511",
        "1091434",
        "4690924",
        "13899961",
        "9148237",
        "8392153",
        "9192819",
        "9152448",
        "10599310",
        "13333172",
        "12259907",
        "9563432",
        "8871163",
        "12547354",
        "6652785",
        "7229211",
        "9166819",
        "11192601",
        "14507739",
        "11960298",
        "10177470",
        "6604445",
        "7271913",
        "7147434",
        "463951",
        "12259769",
        "12130084",
        "12444812",
        "5956392",
        "10860690",
        "4655966",
        "6127084",
        "10424000",
        "11580829",
        "2947022",
        "4652737",
        "8351974",
        "14517453",
        "4548103",
        "12133844",
        "8682777",
        "10709531",
        "6549926",
        "12532449",
        "14090733",
        "7951753",
        "8038880",
        "15026774",
        "11861329",
        "8945622",
        "13058085",
        "7200624",
        "5778909",
        "1250088",
        "8015397",
        "7311031",
        "8058521",
        "13873975",
        "14008863",
        "12644918",
        "8931203",
        "11770155",
        "14728272",
        "8739374",
        "6828391",
        "8798111",
        "12550825",
        "11352615",
        "5797901",
        "10822482",
        "13236499",
        "1741651",
        "12142482",
        "8169513",
        "7879038",
        "7065625",
        "4496536",
        "8940822",
        "7195647",
        "9239090",
        "10981376",
        "9355970",
        "10554482",
        "13645839",
        "1242291",
        "4813082",
        "6354031",
        "9299949",
        "13979021",
        "12231233",
        "10501869",
        "9492646",
        "4368713",
        "9174304",
        "5007034",
        "12216114",
        "9341427",
        "5253681",
        "10381416",
        "11217456",
        "12123556",
        "5424711",
        "9426642",
        "9346498",
        "12493549",
        "12394538",
        "8203844",
        "11077648",
        "12562059",
        "13146530",
        "6539590",
        "11257516",
        "11496746",
        "6468258",
        "10269865",
        "12239716",
        "13624921",
        "6212771",
        "14362783",
        "13360861",
        "13559225",
        "7991538",
        "7460597",
        "6230488",
        "3810994",
        "9683436",
        "9064836",
        "5457917",
        "5669384",
        "9548532",
        "7972391",
        "8993547",
        "10353562",
        "7029961",
        "5880552",
        "11733591",
        "12168871",
        "8338253",
        "2427640",
        "7160046",
        "12051271",
        "12890618",
        "12198087",
        "4002829",
        "4222532",
        "6469233",
        "8850888",
        "4752368",
        "11467350",
        "11966969",
        "2210129",
        "7623617",
        "12049356",
        "4372409",
        "7382073",
        "12247134",
        "13597315",
        "13847865",
        "13094970",
        "12559174",
        "12186020",
        "13257733",
        "8017907",
        "7451936",
        "12999019",
        "12953691",
        "13096138",
        "11477328",
        "5209077",
        "2127550",
        "12786648",
        "10141677",
        "7260761",
        "13766557",
        "7513701",
        "4087896",
        "8184209",
        "2133630",
        "7041605",
        "10272817",
        "11919676",
        "12166248",
        "4373639",
        "12026007",
        "7847206",
        "5438428",
        "9070750",
        "5097099",
        "13241522",
        "11354246",
        "11055487",
        "12471596",
        "12067129",
        "346642",
        "4892173",
        "9830207",
        "9085742",
        "14632548",
        "10952717",
        "8063349",
        "12530403",
        "4809164",
        "9821969",
        "12857331",
        "12298238",
        "4323614",
        "3529658",
        "8439458",
        "10146889",
        "12446538",
        "1885037",
        "13273914",
        "13460731",
        "15156505",
        "6531623",
        "11584683",
        "4920928",
        "8224755",
        "4473468",
        "10473752",
        "1327436",
        "2804677",
        "3135747",
        "8951241",
        "13968263",
        "3537452",
        "11402378",
        "2895911",
        "11886436",
        "3737792",
        "12509291",
        "12796751",
        "13583743",
        "3002134",
        "7783991",
        "7066070",
        "9394570",
        "6671289",
        "7962117",
        "7820366",
        "11458647",
        "9324282",
        "4104410",
        "8951152",
        "14016023",
        "6138173",
        "7248724",
        "6793551",
        "1023871",
        "12070427",
        "7422917",
        "14970387",
        "3600901",
        "6941723",
        "6904160",
        "7713363",
        "13506006",
        "5815222",
        "4679383",
        "5787863",
        "7546245",
        "7989202",
        "6040634",
        "9407531",
        "10726274",
        "10334086",
        "6048388",
        "6467343",
        "10286210",
        "4180274",
        "5157224",
        "14556710",
        "7826535",
        "4565382",
        "11831349",
        "796750",
        "13270047",
        "FC022131",
        "5573497",
        "11966416",
        "10562248",
        "6441391",
        "2877330",
        "6903532",
        "11624278",
        "10651238",
        "6475835",
        "5071335",
        "1253816",
        "6439022",
        "12217146",
        "9133402",
        "4077463",
        "8419662",
        "10847351",
        "9055368",
        "9448173",
        "12339328",
        "6691046",
        "9968221",
        "10848309",
        "10137450",
        "2181904",
        "2078208",
        "6947042",
        "13990840",
        "5931054",
        "9321774",
        "11470715",
        "4530600",
        "4940757",
        "2708722",
        "9692734",
        "11554635",
        "4240366",
        "4352032",
        "2157431",
        "5818128",
        "7935770",
        "4646982",
        "8892392",
        "9713938",
        "8528743",
        "3534973",
        "10673303",
        "4200404",
        "3768270",
        "9174047",
        "4746094",
        "7412051",
        "9498649",
        "OC412121",
        "12059750",
        "629725",
        "13220060",
        "13220010",
        "9560186",
        "6873629",
        "4313788",
        "5469591",
        "2752941",
        "12526037",
        "12369537",
        "6726649",
        "10844999",
        "9630195",
        "10838225",
        "6856631",
        "14200689",
        "10356461",
        "5344172",
        "14203259",
        "11587635",
        "8953594",
        "10474961",
        "13767552",
        "12218651",
        "13718616",
        "10347250",
        "9794174",
        "10122936",
        "1203036",
        "13807464",
        "6813164",
        "3429913",
        "11018248",
        "9089348",
        "11680002",
        "2065014",
        "8411365",
        "12036939",
        "10958431",
        "10067035",
        "8515054",
        "12843732",
        "8213330",
        "3463222",
        "6173773",
        "3274374",
        "6364230",
        "12504529",
        "13390556",
        "868367",
        "1885044",
        "3465315",
        "11231267",
        "10461982",
        "9752735",
        "8773297",
        "8568544",
        "2960253",
        "13900972",
        "2905621",
        "7933857",
        "6703922",
        "6731577",
        "9750931",
        "4698955",
        "4241513",
        "8331586",
        "10828474",
        "13901508",
        "4709464",
        "10907659",
        "9258193",
        "11651337",
        "9812533",
        "1856964",
        "2083463",
        "2590467",
        "8491209",
        "1586702",
        "8231745",
        "4936484",
        "12515858",
        "9730403",
        "8241051",
        "2708833",
        "2934174",
        "10378830",
        "8665358",
        "7937770",
        "4235781",
        "4833865",
        "6906227",
        "8109974",
        "11952408",
        "2390420",
        "7851807",
        "2057887",
        "15247768",
        "12522167",
        "11563019",
        "13693411",
        "11529360",
        "9767652",
        "5734045",
        "113311",
        "6263422",
        "13486998",
        "11839791",
        "4570753",
        "2477552",
        "473038",
        "4217497",
        "10527164",
        "9461365",
        "5268677",
        "14695370",
        "5732395",
        "2900122",
        "4213786",
        "13845395",
        "9726659",
        "5559480",
        "9152372",
        "9281769",
        "4675244",
        "11870417",
        "10740539",
        "10721872",
        "1527360",
        "9288425",
        "2405837",
        "4365075",
        "8210989",
        "13888337",
        "6099893",
        "6868797",
        "6604428",
        "7447550",
        "8387876",
        "14862865",
        "8817828",
        "10582216",
        "4482213",
        "12321173",
        "6846890",
        "10490174",
        "6765219",
        "8792494",
        "6040907",
        "2176652",
        "3575815",
        "13587028",
        "4372955",
        "3943448",
        "5199162",
        "8539140",
        "4298816",
        "3834144",
        "8065244",
        "6881810",
        "5645405",
        "7222863",
        "5663376",
        "6971891",
        "5138491",
        "3912659",
        "13751597",
        "13140084",
        "6850569",
        "428626",
        "3025463",
        "11174378",
        "7758813",
        "14778262",
        "13119566",
        "SC395268",
        "6493880",
        "NI054020",
        "13715590",
        "15204146",
        "NI636506",
        "SC062835",
        "10789198",
        "6231075",
        "3007771",
        "3823043",
        "14347641",
        "SC379991",
        "13610511",
        "SC570853",
        "SC188426",
        "NI049142",
        "4754865",
        "SC377894",
        "5479393",
        "10064439",
        "13234951",
        "9619866",
        "6457355",
        "10955876",
        "9635149",
        "14151358",
        "SC490531",
        "SC551674",
        "14216121",
        "14296961",
        "6192053",
        "11761701",
        "9605153",
        "3504081",
        "2790970",
        "SC256008",
        "10582148",
        "4047282",
        "10040889",
        "SC503895",
        "14261905",
        "10974736",
        "11417352",
        "10164518",
        "NI647748",
        "7369630",
        "7180390",
        "14255335",
        "10523791",
        "6507136",
        "4704440",
        "11236274",
        "4493100",
        "4426001",
        "12204519",
        "9563911",
        "12861772",
        "SC766472",
        "5564268",
        "6850590",
        "5971075",
        "NI026203",
        "4890880",
        "6500345",
        "SC170092",
        "11253302",
        "5766951",
        "SC592658",
        "3260614",
        "8620611",
        "14046522",
        "12383344",
        "11767025",
        "15001607",
        "12133979",
        "5129526",
        "11140783",
        "14272085",
        "4520788",
        "4617005",
        "SC373396",
        "SC800112",
        "11336245",
        "8418032",
        "12014910",
        "7589136",
        "11206372",
        "7993592",
        "SC298321",
        "SC448376",
        "10561067",
        "12754754",
        "SC473252",
        "13939481",
        "11397033",
        "12841546",
        "SC733703",
        "13977697",
        "14329939",
        "11466729",
        "7403663",
        "8229053",
        "12043121",
        "SC331686",
        "13549996",
        "11320954",
        "5692701",
        "7950362",
        "13555881",
        "1388687",
        "3710694",
        "10699159",
        "7245791",
        "12586941",
        "SC698997",
        "14601096",
        "9576899",
        "14257075",
        "6612754",
        "14230575",
        "12426824",
        "SC673522",
        "13938975",
        "SC577285",
        "6354833",
        "NI620657",
        "11803031",
        "SC714988",
        "13498240",
        "7072407",
        "6880882",
        "SC485868",
        "NI014592",
        "12653803",
        "11207105",
        "9237775",
        "9558997",
        "14011661",
        "7573522",
        "13235550",
        "14026681",
        "14128111",
        "7529454",
        "NI608201",
        "11360192",
        "13315929",
        "SC692014",
        "5771376",
        "12907217",
        "4303470",
        "11294679",
        "8568925",
        "7797721",
        "14249640",
        "14479960",
        "13294628",
        "14481979",
        "4941183",
        "5317897",
        "7046461",
        "10460324",
        "5985260",
        "8136605",
        "5520636",
        "SC568420",
        "10085552",
        "1672229",
        "6728389",
        "10542583",
        "8743498",
        "6782810",
        "7278784",
        "SC318966",
        "7531113",
        "7141369",
        "14655486",
        "9610615",
        "13655231",
        "8963048",
        "7591453",
        "12360410",
        "8841067",
        "5471880",
        "5738824",
        "NI646940",
        "7278661",
        "10243024",
        "SC723041",
        "10923370",
        "SC657732",
        "9424738",
        "SC478397",
        "SC473500",
        "13720143",
        "SC624412",
        "12870640",
        "8761549",
        "NI621356",
        "SC422976",
        "5369966",
        "6528306",
        "13746955",
        "11762771",
        "14806898",
        "10530073",
        "SC455091",
        "5529605",
        "8977722",
        "12861134",
        "10617510",
        "11981522",
        "NI646642",
        "SC259893",
        "4777159",
        "SC250677",
        "9582232",
        "11079766",
        "12864672",
        "11286028",
        "7560663",
        "SC120624",
        "14602914",
        "12963411",
        "11370205",
        "9938983",
        "13975232",
        "8672901",
        "9853998",
        "8965577",
        "12568347",
        "NI602690",
        "11537938",
        "SC504424",
        "12424258",
        "9258571",
        "10168302",
        "4214075",
        "6668004",
        "NI665304",
        "7650202",
        "5705656",
        "12671755",
        "10304731",
        "6409369",
        "NI605188",
        "6224051",
        "10905041",
        "SC412449",
        "12269968",
        "12495644",
        "8804074",
        "SC645895",
        "SC244438",
        "12402422",
        "SC596293",
        "3134741",
        "7235585",
        "SC247516",
        "SC375134",
        "12724255",
        "SC122681",
        "7765094",
        "13731154",
        "10848036",
        "SC589290",
        "SC385448",
        "9365860",
        "SC535203",
        "SC766437",
        "14616671",
        "9936352",
        "1254513",
        "12024728",
        "11870644",
        "11729192",
        "10483618",
        "6555696",
        "13829257",
        "14974447",
        "12495780",
        "12326302",
        "12658041",
        "10738959",
        "SC631968",
        "SC623572",
        "12636877",
        "SC244071",
        "SC073543",
        "5622383",
        "11140583",
        "11044265",
        "SC413390",
        "6353002",
        "6627399",
        "11732473",
        "13965906",
        "11693786",
        "15338924",
        "4002758",
        "13917859",
        "14882449",
        "7434168",
        "SC754718",
        "4353979",
        "13196672",
        "NI651731",
        "SC520157",
        "SC629260",
        "13392954",
        "SC522946",
        "11920646",
        "15677532",
        "6412890",
        "13554525",
        "SC507162",
        "8909657",
        "SC566078",
        "13648336",
        "4450826",
        "7558385",
        "12936618",
        "13392113",
        "SC347178",
        "13858560",
        "5380567",
        "SC619773",
        "NI629441",
        "NI688052",
        "SC713622",
        "10165125",
        "SC453951",
        "8968746",
        "11911997",
        "12832207",
        "10543920",
        "1513016",
        "SC293016",
        "9472144",
        "SC559492",
        "10278956",
        "12787270",
        "14788408",
        "8168575",
        "9343176",
        "3533417",
        "10485831",
        "6314070",
        "SC569774",
        "SC180409",
        "SC506462",
        "1929552",
        "7168225",
        "5439121",
        "4214195",
        "SC171308",
        "13233798",
        "11932401",
        "8647739",
        "6675884",
        "8514058",
        "SC647851",
        "8443533",
        "9971461",
        "13955528",
        "11874637",
        "8259851",
        "7857138",
        "6593903",
        "12531133",
        "4208258",
        "12894623",
        "8190336",
        "SC421038",
        "SC565749",
        "SC427745",
        "12863515",
        "12104323",
        "9616455",
        "11423449",
        "11895091",
        "10237249",
        "13360094",
        "3408642",
        "SC561053",
        "1848011",
        "4539822",
        "NI642773",
        "8131083",
        "J1910",
        "6563126",
        "7384148",
        "2943065",
        "NI689258",
        "SC281724",
        "7384841",
        "SC372899",
        "12714158",
        "11749630",
        "NI035996",
        "SC339677",
        "SC265917",
        "10270079",
        "12234787",
        "12974269",
        "SC768872",
        "14298335",
        "12301822",
        "5335288",
        "5770317",
        "12139314",
        "13137752",
        "13075180",
        "SC552413",
        "12765454",
        "14488660",
        "12941925",
        "3108250",
        "14345729",
        "6065960",
        "10870344",
        "8010679",
        "10165689",
        "9602621",
        "13429022",
        "12178487",
        "12700394",
        "10901497",
        "10253168",
        "7013748",
        "SC706429",
        "4882171",
        "10242754",
        "8025080",
        "2101305",
        "10142228",
        "13291361",
        "13850851",
        "14098477",
        "7537047",
        "SC773921",
        "12515139",
        "13484131",
        "10285397",
        "SC722019",
        "15057769",
        "14097320",
        "13788070",
        "SC785923",
        "6991322",
        "14495762",
        "SC257531",
        "SC734265",
        "11203698",
        "13419583",
        "14025129",
        "13826760",
        "SC525401",
        "14713938",
        "14163483",
        "15116148",
        "11300778",
        "SC375423",
        "12307106",
        "14489088",
        "12957407",
        "9698175",
        "8241841",
        "9655804",
        "11072486",
        "7015933",
        "9501358",
        "SC570353",
        "2011437",
        "SC754497",
        "15449911",
        "8298621",
        "13415878",
        "4727470",
        "11465671",
        "13489459",
        "SC246868",
        "726541",
        "SC446422",
        "12871824",
        "7922408",
        "9342379",
        "7095450",
        "3399911",
        "SC624263",
        "2130421",
        "9810291",
        "820498",
        "5611845",
        "12161597",
        "NI683174",
        "12708201",
        "3036319",
        "9299805",
        "11020498",
        "15380170",
        "7783081",
        "7391657",
        "7736613",
        "11618094",
        "13173575",
        "11546017",
        "4858623",
        "7765998",
        "13308075",
        "SC733820",
        "4657287",
        "4931728",
        "SC383915",
        "SC450316",
        "6449287",
        "SC123968",
        "11878803",
        "640746",
        "9618572",
        "1304414",
        "12215042",
        "10969792",
        "10925531",
        "14171055",
        "9871840",
        "15508397",
        "10131119",
        "SC474544",
        "8263988",
        "14821847",
        "13393385",
        "SC640986",
        "5486027",
        "10882125",
        "SC299024",
        "2935534",
        "SC592954",
        "9662619",
        "SC620522",
        "4893022",
        "1041712",
        "5848280",
        "13497140",
        "14017966",
        "SC233387",
        "13021451",
        "9534494",
        "SC771527",
        "15589435",
        "SC629249",
        "11353430",
        "11085736",
        "12158131",
        "11825672",
        "7459327",
        "NI060200",
        "3757703",
        "12890219",
        "13103783",
        "NI672554",
        "14332268",
        "12367975",
        "9676629",
        "11294782",
        "7724733",
        "12720418",
        "10003122",
        "NI012640",
        "SC405163",
        "SC257694",
        "4316082",
        "4271550",
        "5984212",
        "13303585",
        "SC548067",
        "8562636",
        "7239697",
        "NI682172",
        "13601175",
        "10832936",
        "6149804",
        "14302591",
        "7556599",
        "10097422",
        "SC672468",
        "3819244",
        "10308584",
        "4216112",
        "11516448",
        "7789622",
        "6781580",
        "3235366",
        "4696856",
        "4749783",
        "SC684877",
        "13506132",
        "13750442",
        "14354148",
        "12359910",
        "12793849",
        "13843845",
        "2447169",
        "6222413",
        "12966535",
        "13338880",
        "12607130",
        "14351622",
        "7163601",
        "12925878",
        "10937806",
        "7578944",
        "8647159",
        "15060752",
        "6995108",
        "8872031",
        "5833519",
        "9765678",
        "SC696057",
        "4746676",
        "SC238360",
        "SC282068",
        "8829970",
        "6710426",
        "8926809",
        "SC091490",
        "SC803648",
        "12685239",
        "SC605340",
        "SC388683",
        "3462225",
        "10355447",
        "10774757",
        "14953532",
        "SC644973",
        "6455492",
        "SC219630",
        "SC185151",
        "9147812",
        "5337831",
        "14965438",
        "15240138",
        "8554481",
        "7838202",
        "13680969",
        "8437443",
        "12194009",
        "11041126",
        "13956195",
        "13671674",
        "SC720125",
        "13262689",
        "14033334",
        "13921098",
        "12577882",
        "14039376",
        "6381457",
        "12960186",
        "SC717501",
        "14309349",
        "SC588278",
        "4689376",
        "7166680",
        "NI685314",
        "SC100450",
        "NI674540",
        "5057558",
        "SC175789",
        "NI652847",
        "SC558201",
        "SC479426",
        "11326000",
        "NI672044",
        "10580792",
        "13136775",
        "SC422646",
        "8126797",
        "SC416075",
        "11834160",
        "7756467",
        "NI601136",
        "14339923",
        "NI677281",
        "12996688",
        "2523856",
        "13500770",
        "11512856",
        "13272356",
        "1260704",
        "5234123",
        "NI658186",
        "11360332",
        "15154116",
        "7573669",
        "9800683",
        "4833107",
        "SC341093",
        "SC480631",
        "SC236065",
        "4742750",
        "SC475021",
        "6139505",
        "8675176",
        "10285065",
        "7602391",
        "7654276",
        "8553677",
        "SC648388",
        "8270911",
        "NI638131",
        "13737589",
        "SC470066",
        "11462046",
        "7197804",
        "2849971",
        "4335281",
        "14779706",
        "SC697681",
        "2798477",
        "8323987",
        "11848813",
        "8680360",
        "10230715",
        "SC395834",
        "2461841",
        "6127321",
        "SC305632",
        "7615571",
        "11310594",
        "4661748",
        "10343211",
        "FC030221",
        "SC522837",
        "11411622",
        "12613211",
        "6362750",
        "SC762681",
        "8130565",
        "13427688",
        "11759242",
        "SC479893",
        "15571936",
        "14400175",
        "7382911",
        "9959811",
        "14244510",
        "14598274",
        "2474438",
        "SC401613",
        "8629655",
        "11499849",
        "7844804",
        "784133",
        "10813979",
        "SC679962",
        "SC350024",
        "12484156",
        "9277493",
        "11894503",
        "11029258",
        "4749783",
        "4002758",  # Example company number
    ]
    
    # Initialize the HMRC client
    hmrc_client = HMRCClient()

    for number in company_numbers:
        # Get company name
        company_name = get_company_name(number)
        
        # Get all directors' details (names and ages)
        directors = get_directors_details(number)
        
        # Get the VAT number (for example, use company_number as VRN for testing)
        vat_number = f"GB{number}"  # You can modify this logic depending on how you retrieve VAT numbers
        
        # Get turnover from HMRC
        turnover = get_company_turnover(hmrc_client, vat_number)
        
        # Only save companies where at least one director is over 50 and turnover is £1M or more
        if turnover and turnover >= 1000000 and directors:
            qualifying_directors = [d for d in directors if "Age:" in d and int(d.split("Age:")[1].strip(")")) > 50]
            if qualifying_directors:
                directors_str = "; ".join(qualifying_directors)
                turnover_str = f"£{turnover:,.2f}"
                writer.writerow({
                    'Company Number': number,
                    'Company Name': company_name,
                    'Directors (Name and Age)': directors_str,
                    'Annual Turnover': turnover_str
                })
                print(f"Company {number} ({company_name}): Directors: {directors_str}, Turnover: {turnover_str}")
            else:
                print(f"Company {number} ({company_name}): No qualifying directors, skipping.")
        else:
            print(f"Company {number}: No valid data or turnover is less than £1M, skipping.")
